"use strict";(self["webpackChunkgenshin_artifacts"]=self["webpackChunkgenshin_artifacts"]||[]).push([[726],{37632:function(t,e,a){a.d(e,{Z:function(){return h}});var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"item br-3",on:{click:function(e){return t.$emit("click")}}},[a("div",{staticClass:"header"},[a("span",{staticClass:"fs-12"},[t._v(t._s(t.name))]),t.toolbar?a("div",{staticClass:"buttons flex-row"},[a("el-button",{staticClass:"button",attrs:{icon:"el-icon-delete",type:"text",size:"mini",circle:"",title:"删除"},on:{click:function(e){return e.stopPropagation(),t.$emit("delete")}}}),a("el-button",{staticClass:"button",attrs:{icon:"el-icon-download",type:"text",size:"mini",circle:"",title:"导出"},on:{click:function(e){return e.stopPropagation(),t.$emit("download")}}})],1):t._e()]),a("div",{staticClass:"body"},[a("div",{staticClass:"detail-div fs-12"},[a("img",{staticClass:"c-avatar br-50p",attrs:{src:t.characterAvatar}}),a("span",[t._v(t._s(t.characterChs))])]),a("div",{staticClass:"detail-div fs-12"},[a("img",{staticClass:"w-avatar br-50p",attrs:{src:t.weaponData.url}}),a("span",[t._v(t._s(t.weaponData.chs))])]),a("div",{staticClass:"detail-div fs-12"},[a("img",{staticClass:"tf-avatar br-50p",attrs:{src:t.tfData.badge}}),a("span",[t._v(t._s(t.tfData.chs))])])])])},i=[],s=a(12637),n=a(51775),l=a(43073),c={name:"PresetItem",props:{item:{type:Object,required:!0},name:{},toolbar:{type:Boolean,default:!0}},computed:{characterName(){return this.item.character.name},characterAvatar(){const t=s.O[this.characterName];return t.avatar},characterChs(){const t=s.O[this.characterName];return t.chs},weaponData(){return n.G[this.item.weapon.name]},tfData(){return l.F[this.item.targetFunction.name]}}},o=c,f=a(1001),d=(0,f.Z)(o,r,i,!1,null,"49ba95be",null),h=d.exports},46499:function(t,e,a){a.d(e,{Z:function(){return o}});var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{ref:"rootBox",staticClass:"root",class:{over:t.isDragOver},on:{dragenter:t.handleDragEnter,dragleave:t.handleDragLeave,dragover:t.handleDragover,drop:t.handleDrop,click:t.handleClick}},[t._m(0)]),t.hasFile?a("p",{staticClass:"filename"},[t._v(t._s(t.fileName))]):t._e(),a("input",{ref:"fileInput",staticClass:"file-input",attrs:{type:"file"},on:{change:t.handleSelectFile}})])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"center-div"},[a("i",{staticClass:"el-icon-upload"}),a("span",[t._v("点击，或拖拽上传")])])}],s={name:"ImportBlock",mounted(){this.file=null},data(){return{isDragOver:!1,hasFile:!1,fileName:""}},methods:{handleDrop(t){t.preventDefault(),this.isDragOver=!1;let e=null;if(t.dataTransfer.items){for(let a=0;a<t.dataTransfer.items.length;a++)if("file"===t.dataTransfer.items[a].kind){e=t.dataTransfer.items[a].getAsFile();break}}else e=t.dataTransfer.files[0].name;this.file=e,e&&(this.hasFile=!0,this.fileName=e.name)},getReadPromise(){return new Promise(((t,e)=>{this.file||e("未选择文件");try{let a=new FileReader;a.onload=e=>{t(e.target.result)},a.onerror=t=>{e(t)},a.readAsText(this.file)}catch(a){e(a)}}))},handleDragEnter(t){t.preventDefault(),this.isDragOver=!0},handleDragLeave(t){t.preventDefault(),this.isDragOver=!1},handleDragover(t){t.preventDefault()},handleClick(){const t=this.$refs["fileInput"];t&&t.click()},handleSelectFile(t){const e=this.$refs["fileInput"];if(!e)return;const a=Array.from(e.files);a.length>0&&(this.file=a[0],this.hasFile=!0,this.fileName=a[0].name)}}},n=s,l=a(1001),c=(0,l.Z)(n,r,i,!1,null,"d75e0f8c",null),o=c.exports},2706:function(t,e,a){a.r(e),a.d(e,{default:function(){return D}});var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{attrs:{visible:t.showImportDialog,title:"导入",width:"60%"},on:{"update:visible":function(e){t.showImportDialog=e}},scopedSlots:t._u([{key:"footer",fn:function(){return[a("el-button",{on:{click:function(e){t.showImportDialog=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.handleImport}},[t._v("确定")])]},proxy:!0}])},[a("import-block",{ref:"importBlock"})],1),a("el-drawer",{attrs:{visible:t.showArtifactsScoreDrawer,title:"推荐圣遗物",size:t.deviceIsPC?"30%":"100%"},on:{"update:visible":function(e){t.showArtifactsScoreDrawer=e}}},[0===t.artifactScoreList.length?a("el-empty"):a("div",{staticClass:"artifact-score-list-div"},t._l(t.artifactsScoreListCut,(function(e,r){return a("div",{key:r},[a("artifact-display",{staticClass:"artifact-score-item",attrs:{item:t.artifactsById[e[0]],"show-back":!0,"back-value":e[1]}})],1)})),0)],1),a("div",{staticClass:"toolbar"},[a("el-button",{attrs:{icon:"el-icon-download",size:"mini"},on:{click:t.handleExportAll}},[t._v("导出全部")]),a("el-button",{attrs:{icon:"el-icon-upload2",size:"mini"},on:{click:t.handleClickImport}},[t._v("导入")])],1),t.presetsLength>0?a("div",{staticClass:"body"},t._l(t.allFlat,(function(e){return a("preset-item",{key:e.name,staticClass:"item",attrs:{item:e.item,name:e.name},on:{delete:function(a){return t.handleDeletePreset(e.name)},download:function(a){return t.handleDownload(e.name)},click:function(a){return t.test(e.name)}}})})),1):[a("el-empty",[a("p",{staticStyle:{"font-size":"0.9em",color:"#606266"}},[t._v(" 请前往"),a("span",{staticClass:"route-item",on:{click:function(e){return t.$router.replace("/calculate")}}},[t._v("计算器")]),t._v("页面添加预设 ")])])]],2)},i=[],s=a(26294),n=a(39285),l=a(76711),c=a(65735),o=a(44368),f=a(60058),d=a(37632),h=a(46499),u=a(65010),m={name:"CharacterPresetsPage",components:{PresetItem:d.Z,ImportBlock:h.Z,ArtifactDisplay:u.Z},created(){},data(){return{showImportDialog:!1,showArtifactsScoreDrawer:!1,artifactScoreList:[],deviceIsPC:f.B}},methods:{checkImportType(t){return Object.prototype.hasOwnProperty.call(t,"data")?"multi":"single"},async handleImport(){const t=this.$refs.importBlock;if(!t)return;const e=await t.getReadPromise();let a=null;try{a=JSON.parse(e)}catch{a=null}const r=(0,n.mf)(a);if(r){for(let t of a)(0,n.y0)(t.item,t.name);this.showImportDialog=!1}else this.$message.error("导入格式错误")},handleDeletePreset(t){(0,n.UK)(t)},handleDownload(t){const e=(0,n.kE)(t),a=[e],r=JSON.stringify(a);(0,l.Qz)(r,"text/plain",t)},handleExportAll(){const t=JSON.stringify(this.allFlat);(0,l.Qz)(t,"text/plain","预设")},handleClickImport(){this.showImportDialog=!0},test(t){console.log(t);const e=(0,n.kE)(t).item;if(!e)return;const a=e.character,r=e.weapon,i=e.targetFunction,s=this.allArtifactsFlat.map((t=>(0,c.Lz)(t)));(0,o.eH)(a,r,i,s).then((t=>{t=t.filter((t=>0===this.artifactsById[t[0]].level)),this.artifactScoreList=t;const e=t.map((t=>t[1])).reduce(((t,e)=>Math.max(t,e)),0);if(console.log(e),e>0)for(let a=0;a<t.length;a++)t[a][1]/=e;this.showArtifactsScoreDrawer=!0}))}},computed:{...(0,s.mapGetters)("presets",["allFlat"]),...(0,s.mapGetters)("artifacts",{allArtifactsFlat:"allFlat",artifactsById:"artifactsById"}),presetsLength(){return this.allFlat.length},artifactsScoreListCut(){return this.artifactScoreList.slice(0,20)}}},p=m,v=a(1001),g=(0,v.Z)(p,r,i,!1,null,"76de68cd",null),D=g.exports}}]);
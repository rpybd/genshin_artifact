"use strict";(self["webpackChunkgenshin_artifacts"]=self["webpackChunkgenshin_artifacts"]||[]).push([[416],{89415:function(t,e,i){i.d(e,{Z:function(){return o}});var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"button-root",on:{click:function(e){return t.$emit("click")}}},[i("i",{class:[t.icon]})])},r=[],a={name:"MyButton1",props:{icon:{default:"el-icon-delete"}}},s=a,l=i(1001),c=(0,l.Z)(s,n,r,!1,null,"a232d95c",null),o=c.exports},96186:function(t,e,i){i.d(e,{Z:function(){return o}});var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"root",on:{click:function(e){return t.$emit("click")}}},[""!==t.back?i("img",{attrs:{src:t.back}}):t._e(),i("span",{staticClass:"s1"}),i("span",{staticClass:"s2"}),i("span",{staticClass:"s3"}),i("span",{staticClass:"s4"}),t._v(" + ")])},r=[],a={name:"AddButton",props:{back:{default:""}}},s=a,l=i(1001),c=(0,l.Z)(s,n,r,!1,null,"f016431a",null),o=c.exports},24882:function(t,e,i){i.d(e,{Z:function(){return p}});var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"filters"},[i("select-artifact-main-stat",{attrs:{placeholder:"主词条"},model:{value:t.filterMainTag,callback:function(e){t.filterMainTag=e},expression:"filterMainTag"}}),i("select-artifact-set",{attrs:{"any-option":"",placeholder:"套装"},model:{value:t.filterArtifactSetName,callback:function(e){t.filterArtifactSetName=e},expression:"filterArtifactSetName"}})],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.artifactListDisplayed.length>0,expression:"artifactListDisplayed.length > 0"}],staticClass:"artifacts"},t._l(t.artifactListDisplayed,(function(e){return i("artifact-display",{key:e.id,attrs:{item:e,selectable:""},on:{click:function(i){return t.$emit("select",e.id)}}})})),1),i("div",{directives:[{name:"show",rawName:"v-show",value:0===t.artifactListDisplayed.length,expression:"artifactListDisplayed.length === 0"}],staticClass:"no-artifacts"},[i("el-empty")],1),i("el-pagination",{attrs:{"current-page":t.currentPage,"page-size":t.pageSize,total:t.artifactList.length,layout:"prev, pager, next",small:!t.deviceIsPC},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1)},r=[],a=i(60058),s=i(81835),l=i(37854),c=i(65010);const o=20;var u={name:"SelectArtifact",components:{SelectArtifactMainStat:s.Z,SelectArtifactSet:l.Z,ArtifactDisplay:c.Z},props:{position:{}},created(){this.pageSize=o},data(){return{filterMainTag:"any",filterArtifactSetName:"any",currentPage:1,deviceIsPC:a.B}},computed:{artifactListUnfiltered(){if("any"===this.position)return this.$store.getters["artifacts/allFlat"];const t=this.$store.state.artifacts[this.position];return t},artifactList(){let t=[];for(let e of this.artifactListUnfiltered)"any"!==this.filterMainTag&&this.filterMainTag!==e.mainTag.name||"any"!==this.filterArtifactSetName&&this.filterArtifactSetName!==e.setName||t.push(e);return t},artifactListDisplayed(){const t=(this.currentPage-1)*o,e=Math.min(t+o,this.artifactList.length);return this.artifactList.slice(t,e)}}},d=u,f=i(1001),m=(0,f.Z)(d,n,r,!1,null,"655ebd7b",null),p=m.exports},81835:function(t,e,i){i.d(e,{Z:function(){return u}});var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-select",{attrs:{value:t.value,size:"small",multiple:t.multiple,placeholder:t.placeholder},on:{input:function(e){return t.$emit("input",e)}}},[t.includeAny?i("el-option",{attrs:{label:"任意",value:"any"}}):t._e(),t._l(t.tagList,(function(t){return i("el-option",{key:t.name,attrs:{label:t.title,value:t.name}})}))],2)},r=[],a=i(98017),s={name:"SelectArtifactMainStat",props:{value:{},includeAny:{default:!0},multiple:{default:!1},position:{default:null},placeholder:{type:String,default:"请选择"}},computed:{tagList(){let t=[];if(this.position)for(let e of a.nl[this.position])t.push({name:e,title:a.vB[e].chs});else for(let e in a.vB)t.push({name:e,title:a.vB[e].chs});return t}}},l=s,c=i(1001),o=(0,c.Z)(l,n,r,!1,null,null,null),u=o.exports},37854:function(t,e,i){i.d(e,{Z:function(){return m}});var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-select",{attrs:{value:t.value,disabled:t.disabled,size:"small",multiple:t.multiple,"multiple-limit":t.multipleLimit,placeholder:t.placeholder},on:{input:function(e){return t.$emit("input",e)}}},[t.anyOption?i("el-option",{attrs:{label:"任意",value:"any"}}):t._e(),t._l(t.allArtifactsName,(function(e){return i("el-option",{key:e.name,attrs:{label:e.chs,value:e.name}},[i("div",{staticClass:"item"},[i("img",{staticClass:"tn",attrs:{src:e.url}}),i("span",[t._v(t._s(e.chs))])])])}))],2)},r=[],a=i(36110),s=i(4222);let l=Object.values(a.oN);l.sort(((t,e)=>e.maxStar-t.maxStar));let c=l.map((t=>({name:t.eng,chs:t.chs,url:(0,s.Lk)(t.eng)})));var o={name:"SelectArtifactSet",created:function(){this.allArtifactsName=c},props:{value:{type:String|Array,required:!0},disabled:{type:Boolean,default:!1},anyOption:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},multipleLimit:{default:2},placeholder:{type:String,default:"请选择"}}},u=o,d=i(1001),f=(0,d.Z)(u,n,r,!1,null,"ee44e4fe",null),m=f.exports},99918:function(t,e,i){i.r(e),i.d(e,{default:function(){return $}});var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-dialog",{attrs:{visible:t.showSelectArtifactDialog,title:"选择圣遗物",width:"80%"},on:{"update:visible":function(e){t.showSelectArtifactDialog=e}}},[i("select-artifact",{attrs:{position:t.selectArtifactPosition},on:{select:t.handleSelectArtifact}})],1),i("div",{staticClass:"m-toolbar hidden-md-and-up"},[i("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[i("span",[i("i",{staticClass:"el-icon-more"})]),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:"add"}},[i("i",{staticClass:"el-icon-plus"}),t._v("新建收藏夹")]),i("el-dropdown-item",{attrs:{command:"addKumi"}},[i("i",{staticClass:"el-icon-plus"}),t._v("新建圣遗物组")]),0!==t.currentDirId?i("el-dropdown-item",{attrs:{command:"delete"}},[i("i",{staticClass:"el-icon-delete"}),t._v('删除"'+t._s(t.currentDirTitle)+'"')]):t._e(),0!==t.currentDirId?i("el-dropdown-item",{attrs:{command:"rename"}},[i("i",{staticClass:"el-icon-edit"}),t._v("重命名")]):t._e(),t._l(t.items,(function(e,n){return i("el-dropdown-item",{key:e.index,attrs:{divided:0===n,command:"use "+e.index}},[i("i",{staticClass:"el-icon-menu"}),t._v(t._s(e.title))])}))],2)],1),i("div",{staticClass:"m-middle"},[t._v(" "+t._s(t.currentDirTitle)+" ")])],1),i("div",{staticClass:"pc-container"},[i("div",{staticClass:"left mona-scroll-hidden hidden-sm-and-down"},[i("div",{staticClass:"toolbar"},[i("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-plus"},on:{click:t.handleNewDir}},[t._v(" 新建收藏夹 ")])],1),i("div",{staticClass:"mona-scroll-hidden left-list"},[i("my-list",{attrs:{items:t.items},model:{value:t.currentDirId,callback:function(e){t.currentDirId=e},expression:"currentDirId"}})],1)]),i("div",{staticClass:"right mona-scroll-hidden"},[i("div",{staticClass:"hidden-md-and-up"},[i("el-input",{staticStyle:{"margin-bottom":"12px"},attrs:{size:"mini",placeholder:"搜索"},scopedSlots:t._u([{key:"append",fn:function(){return[i("i",{staticClass:"el-icon-search"})]},proxy:!0}]),model:{value:t.searchString,callback:function(e){t.searchString=e},expression:"searchString"}})],1),i("div",{staticClass:"toolbar2 hidden-sm-and-down"},[i("div",{staticClass:"button-left"},[i("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-plus"},on:{click:t.handleNewKumi}},[t._v("新建组")]),i("el-input",{staticStyle:{"margin-left":"16px"},attrs:{size:"mini",placeholder:"搜索"},scopedSlots:t._u([{key:"append",fn:function(){return[i("i",{staticClass:"el-icon-search"})]},proxy:!0}]),model:{value:t.searchString,callback:function(e){t.searchString=e},expression:"searchString"}})],1),i("div",{staticClass:"button-right"},[0!==t.currentDirId?i("el-button",{attrs:{size:"mini",type:"danger",title:"删除收藏夹"},on:{click:function(e){return t.handleDeleteDir(t.currentDirId)}}},[i("i",{staticClass:"el-icon-delete"})]):t._e(),0!==t.currentDirId?i("el-button",{attrs:{size:"mini",icon:"el-icon-edit"},on:{click:function(e){return t.handleRenameDir(t.currentDirId)}}},[t._v("重命名")]):t._e()],1)]),i("div",{staticClass:"items mona-scroll-hidden"},[t.filteredKumiList.length>0?i("div",t._l(t.filteredKumiList,(function(e){return i("kumi-item",{key:e.id,attrs:{data:e},on:{delete:function(i){return t.handleDeleteKumi(e.id)},edit:function(i){return t.handleEditKumi(e.id)},click:function(i){return t.handleClickPosition(e.id,i)},deleteArtifact:function(i){return t.handleDeleteArtifact(e.id,i)}}})})),1):i("div",[i("el-empty")],1)])])])],1)},r=[],a=i(26294),s=i(42246),l=i(81289),c=i.n(l),o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",t._l(t.items,(function(e){return i("li",{key:e.index,class:{active:e.index===t.value},on:{click:function(i){return t.$emit("input",e.index)}}},[t._v(" "+t._s(e.title)+" ")])})),0)},u=[],d={name:"MyList",props:["value","items"]},f=d,m=i(1001),p=(0,m.Z)(f,o,u,!1,null,"93c69620",null),h=p.exports,v=i(89415),y=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"up"},[i("p",{staticClass:"title"},[t._v(t._s(t.data.title))]),i("div",{staticClass:"buttons"},[i("el-button",{attrs:{type:"text",icon:"el-icon-delete",title:"删除"},on:{click:function(e){return t.$emit("delete")}}}),i("el-button",{attrs:{type:"text",icon:"el-icon-edit",title:"重命名"},on:{click:function(e){return t.$emit("edit")}}})],1)]),i("div",{staticClass:"body"},[t._l(t.positions,(function(e){return[t.artifactBySlot[e]?i("artifact-display",{key:e,staticClass:"artifact-item",attrs:{width:"200px",item:t.artifactBySlot[e],selectable:"",buttons:!0,"lock-button":!1,"delete-button":!0},on:{click:function(i){return t.$emit("click",e)},delete:function(i){return t.$emit("deleteArtifact",t.artifactBySlot[e].id)}}}):i("add-button",{key:e,staticClass:"artifact-item",on:{click:function(i){return t.$emit("click",e)}}})]}))],2)])},g=[],k=i(98017),D=i(96186),I=i(65010),_={name:"KumiItem",components:{AddButton:D.Z,ArtifactDisplay:I.Z},props:["data"],created(){this.positions=k.m7},computed:{...(0,a.mapGetters)("artifacts",["artifactsById"]),artifacts(){let t=[];for(let e of this.data.artifactIds)Object.prototype.hasOwnProperty.call(this.artifactsById,e)&&t.push(this.artifactsById[e]);return t},artifactBySlot(){let t={};for(let e of this.artifacts){const i=e.position;t[i]=e}return t}}},S=_,C=(0,m.Z)(S,y,g,!1,null,"22701bd6",null),b=C.exports,w=i(24882),A={name:"KumiPage",components:{MyButton1:v.Z,MyList:h,KumiItem:b,SelectArtifact:w.Z},data(){return{currentDirId:0,showSelectArtifactDialog:!1,selectArtifactPosition:"flower",underSelectionKumiId:0,searchString:""}},computed:{...(0,a.mapGetters)("kumi",["directories","kumiByDir"]),items(){let t=[];for(let e of this.directories)t.push({index:e.id,title:e.title});return t},currentDirTitle(){for(let t of this.directories)if(t.id===this.currentDirId)return t.title;return""},currentKumiList(){return(0,s.j8)(this.currentDirId)},fuse(){return new(c())(this.currentKumiList,{keys:["title"]})},filteredKumiList(){if(""===this.searchString)return this.currentKumiList;const t=this.fuse.search(this.searchString);return t.map((t=>t.item))}},watch:{"$store.state.accounts.currentAccountId":{handler(){this.currentDirId=0},immediate:!1}},methods:{handleCommand(t){"add"===t?this.handleNewDir():t.startsWith("use")?this.currentDirId=parseInt(t.split(" ")[1]):"delete"===t?this.handleDeleteDir(this.currentDirId):"rename"===t?this.handleRenameDir(this.currentDirId):"addKumi"===t&&this.handleNewKumi()},handleNewDir(){this.getInputDirName("新建","收藏夹名").then((t=>{(0,s.jq)(t)})).catch(this.handleInputResult)},handleDeleteDir(t){0!==t&&(0,s.P$)(t)},handleRenameDir(t){this.getInputDirName("重命名","新收藏夹名").then((e=>{(0,s.UE)(t,e)})).catch(this.handleInputResult)},handleNewKumi(){this.getInputKumiName("新建","圣遗物组名").then((t=>{(0,s.Ee)(this.currentDirId,t)})).catch(this.handleInputResult)},handleDeleteKumi(t){(0,s.At)(t)},handleEditKumi(t){this.getInputKumiName("重命名","新圣遗物组名").then((e=>{(0,s.UE)(t,e)})).catch(this.handleInputResult)},handleSelectArtifact(t){this.showSelectArtifactDialog=!1,(0,s.JN)(this.underSelectionKumiId,t)},handleDeleteArtifact(t,e){(0,s.fF)(t,e)},handleClickPosition(t,e){this.selectArtifactPosition=e,this.showSelectArtifactDialog=!0,this.underSelectionKumiId=t},handleInputResult(t){t.error&&this.$message.error(t.reason)},getInputKumiName(t,e){return new Promise(((i,n)=>{this.$prompt(e??"请输入名称",t??"名称",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((({value:t})=>{const e=(0,s.O5)(this.currentDirId,t);e.error?n({error:!0,reason:e.reason}):i(t)})).catch((()=>{n({error:!1,reason:null})}))}))},getInputDirName(t,e){return new Promise(((i,n)=>{this.$prompt(e??"请输入名称",t??"名称",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((({value:t})=>{const e=(0,s.ym)(t);e.error?n({error:!0,reason:e.reason}):i(t)})).catch((()=>{n({error:!1,reason:null})}))}))}}},x=A,Z=(0,m.Z)(x,n,r,!1,null,"9675ae58",null),$=Z.exports},42246:function(t,e,i){i.d(e,{At:function(){return m},Ee:function(){return d},GV:function(){return f},JN:function(){return y},O5:function(){return u},P$:function(){return h},UE:function(){return p},fF:function(){return g},j8:function(){return o},jq:function(){return l},wJ:function(){return k},ym:function(){return c}});var n=i(55138);function r(){let t=n.Z.getters["kumi/dirNames"];for(let e=0;e<100;e++){const i=`收藏夹${e}`;if(!t.has(i))return i}return`收藏夹${Math.floor(1e5*Math.random())}`}function a(t){const e=o(t);let i=new Set;for(let n of e)i.add(n.title);return i}function s(t){let e=a(t);for(let i=0;i<100;i++){const t=`圣遗物组${i}`;if(!e.has(t))return t}return`圣遗物组${Math.floor(1e5*Math.random())}`}function l(t){const e=t??r();n.Z.commit("kumi/newDir",{name:e})}function c(t){if(""===t||!t)return{error:!0,reason:"名称为空"};const e=n.Z.getters["kumi/dirNames"];return e.has(t)?{error:!0,reason:"名称已存在"}:{error:!1}}function o(t){const e=n.Z.getters["kumi/kumiByDir"][t];if(!e)return[];const i=n.Z.state.kumi.kumi;let r=[];for(let n of e)r.push(i[n]);return r}function u(t,e){if(""===e||!e)return{error:!0,reason:"名称为空"};let i=a(t);return i.has(e)?{error:!0,reason:"名称已存在"}:{error:!1}}function d(t,e){const i=e??s(t);n.Z.commit("kumi/newKumi",{artifactIds:[],title:i,dirId:t})}function f(t,e,i){n.Z.commit("kumi/newKumi",{artifactIds:i,title:e,dirId:t})}function m(t){n.Z.commit("kumi/deleteKumi",{id:t})}function p(t,e){n.Z.commit("kumi/renameItem",{id:t,name:e})}function h(t){n.Z.commit("kumi/deleteDir",{id:t})}function v(t){return n.Z.state.kumi.kumi[t]}function y(t,e){const i=n.Z.getters["artifacts/artifactsById"],r=i[e];if(!r)return;const a=r.position;let s=[e];const l=v(t);if(!l)return;const c=l.artifactIds??[];for(let n of c){const t=i[n];t&&t.position===a||s.push(n)}n.Z.commit("kumi/updateKumiArtifact",{artifactIds:s,kumiId:t})}function g(t,e){const i=v(t);if(!i)return;let r=i.artifactIds??[],a=r.indexOf(e);-1!==a&&r.splice(a,1),n.Z.commit("kumi/updateKumiArtifact",{artifactIds:r,kumiId:t})}function k(t){const e=v(t);if(!e)return[];let i=e.artifactIds??[],n=new Set;for(let r of i)n.add(r);return n}}}]);